from collections import deque
result = deque([[[1.6507384777069092, 1.4873101711273193, 1.3550634384155273, 1.2783983945846558, 1.1783393621444702, 1.1106206178665161, 1.0721849203109741, 1.0214048624038696, 1.0141781568527222, 0.9834390878677368, 0.9665386080741882, 0.9835817813873291, 0.9920657873153687, 0.9846996068954468, 1.0176012516021729, 1.0601989030838013, 1.0844805240631104, 1.142841100692749, 1.2401092052459717, 1.3104132413864136, 1.4431897401809692, 1.5895545482635498, 1.800435185432434, 2.118415594100952, 2.5398452281951904, 3.247931480407715, 3.401660919189453, 3.343667507171631, 3.308647871017456, 2.30271315574646, 3.347623109817505, 3.40012526512146, 3.496398448944092, 3.5, 3.5, 2.1358063220977783, 1.8814789056777954, 1.6944615840911865, 1.5745757818222046, 3.5, 3.121199131011963, 3.5, 3.5, 3.5, 3.5, 3.5, 3.5, 3.5, 2.4851109981536865, 2.5194618701934814, 2.5938899517059326, 1.3914543390274048, 1.319932222366333, 1.445549726486206, 3.5, 3.5, 3.5, 0.27048948407173157, 0.2460491806268692, 0.25810596346855164, 0.2412053793668747, 0.22494004666805267, 0.2171536237001419, 0.2027573138475418, 0.22645272314548492, 0.22439531981945038, 3.0160844326019287, 3.074143886566162, 2.766228675842285, 2.2400424480438232, 1.883723258972168, 1.6612261533737183, -0.1, 1.03, 0.2, 63], False, False, 0.0029654145240783636, 1.9090662002563477], [[1.6507384777069092, 1.4873101711273193, 1.3550634384155273, 1.2783983945846558, 1.1783393621444702, 1.1106206178665161, 1.0721849203109741, 1.0214048624038696, 1.0141781568527222, 0.9834390878677368, 0.9665386080741882, 0.9835817813873291, 0.9920657873153687, 0.9846996068954468, 1.0176012516021729, 1.0601989030838013, 1.0844805240631104, 1.142841100692749, 1.2401092052459717, 1.3104132413864136, 1.4431897401809692, 1.5895545482635498, 1.800435185432434, 2.118415594100952, 2.5398452281951904, 3.247931480407715, 3.401660919189453, 3.343667507171631, 3.308647871017456, 2.30271315574646, 3.347623109817505, 3.40012526512146, 3.496398448944092, 3.5, 3.5, 2.1358063220977783, 1.8814789056777954, 1.6944615840911865, 1.5745757818222046, 3.5, 3.121199131011963, 3.5, 3.5, 3.5, 3.5, 3.5, 3.5, 3.5, 2.4851109981536865, 2.5194618701934814, 2.5938899517059326, 1.3914543390274048, 1.319932222366333, 1.445549726486206, 3.5, 3.5, 3.5, 0.27048948407173157, 0.2460491806268692, 0.25810596346855164, 0.2412053793668747, 0.22494004666805267, 0.2171536237001419, 0.2027573138475418, 0.22645272314548492, 0.22439531981945038, 3.0160844326019287, 3.074143886566162, 2.766228675842285, 2.2400424480438232, 1.883723258972168, 1.6612261533737183, -0.35, 1.0, 0.2, 63], False, False, 0.005947029590606695, 1.8064677715301514], [[1.6507384777069092, 1.4873101711273193, 1.3550634384155273, 1.2783983945846558, 1.1783393621444702, 1.1106206178665161, 1.0721849203109741, 1.0214048624038696, 1.0141781568527222, 0.9834390878677368, 0.9665386080741882, 0.9835817813873291, 0.9920657873153687, 0.9846996068954468, 1.0176012516021729, 1.0601989030838013, 1.0844805240631104, 1.142841100692749, 1.2401092052459717, 1.3104132413864136, 1.4431897401809692, 1.5895545482635498, 1.800435185432434, 2.118415594100952, 2.5398452281951904, 3.247931480407715, 3.401660919189453, 3.343667507171631, 3.308647871017456, 2.30271315574646, 3.347623109817505, 3.40012526512146, 3.496398448944092, 3.5, 3.5, 2.1358063220977783, 1.8814789056777954, 1.6944615840911865, 1.5745757818222046, 3.5, 3.121199131011963, 3.5, 3.5, 3.5, 3.5, 3.5, 3.5, 3.5, 2.4851109981536865, 2.5194618701934814, 2.5938899517059326, 1.3914543390274048, 1.319932222366333, 1.445549726486206, 3.5, 3.5, 3.5, 0.27048948407173157, 0.2460491806268692, 0.25810596346855164, 0.2412053793668747, 0.22494004666805267, 0.2171536237001419, 0.2027573138475418, 0.22645272314548492, 0.22439531981945038, 3.0160844326019287, 3.074143886566162, 2.766228675842285, 2.2400424480438232, 1.883723258972168, 1.6612261533737183, -0.35, 1.0, 0.2, 63], False, False, 0.005947029590606695, 1.8064677715301514], [[1.0921624898910522, 1.0518819093704224, 1.0243170261383057, 0.99631267786026, 0.9782143831253052, 0.9538625478744507, 0.9595616459846497, 0.9633384943008423, 0.9757308959960938, 1.0067185163497925, 1.027449607849121, 1.0758048295974731, 1.108715534210205, 1.1989599466323853, 1.2809897661209106, 1.435763955116272, 1.5698410272598267, 1.7617251873016357, 2.0687921047210693, 2.4706032276153564, 3.1636815071105957, 3.4410250186920166, 3.3876545429229736, 3.3458852767944336, 2.3466222286224365, 3.383491277694702, 3.4401473999023438, 3.5, 3.5, 3.5, 2.1799755096435547, 1.9155229330062866, 1.7366323471069336, 1.5915831327438354, 3.5, 3.1636509895324707, 3.5, 3.5, 3.5, 3.5, 3.5, 3.5, 3.5, 2.488725185394287, 2.553828001022339, 2.645674228668213, 1.3614290952682495, 1.3149429559707642, 3.5, 3.5, 3.5, 0.23703265190124512, 0.23461462557315826, 0.23128476738929749, 0.19916650652885437, 0.19587847590446472, 0.17638234794139862, 0.17988580465316772, 0.17582574486732483, 0.18941278755664825, 0.1734616458415985, 2.9553723335266113, 3.053882122039795, 2.76706862449646, 2.23115611076355, 1.880924105644226, 1.6595174074172974, 1.4719716310501099, 1.3380464315414429, 1.245926022529602, 1.1656384468078613, 1.0937869548797607, -0.35, 1.0, 0.17, 60], True, False, 0, 0]], maxlen=4)

from TD3.TD3 import TD3
load_directory = "steer&spd/models115_laser72" # save trained models
load_filename = "TD3_{}".format("stage2")
td3_network = TD3(0.0, 76, 2, 1)
td3_network.load(load_directory,load_filename)
import time
import torch
import numpy as np
import matplotlib.pyplot as plt
ax4 = plt.axes(projection='3d')
start = time.time()
for i in range(-10,10):
    for j in range(-10,10):
        state = torch.from_numpy(np.array(result[-1][0])).float()
        action = td3_network.select_action(state).reshape(1,-1)
        state = state.reshape(1,-1).cuda()
        action[0][0] = i/10
        action[0][1] = j/10
        action = torch.FloatTensor(action).reshape(1,-1).cuda()
        q1,q2 = td3_network.analyze_action(state,action)
        q = min(q1.data,q2.data)

        ax4.scatter(i,j,float(q.detach().cpu()))
plt.show()